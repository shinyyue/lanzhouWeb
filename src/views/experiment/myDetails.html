<div id="experiment-my-details">
    <div class="course-title">
        <div class="course-title-location">
            <span>您的位置：</span>
            <span>实验管理 > 我的实验库 > 查看实验信息</span>
        </div>
    </div>
    <div class="my-details-inner">
        <div class="layui-row">
            <div class="layui-col-md6 layui-form-item">
                <label class="layui-form-label ">实验名称</label>
                <span id="name"></span>
            </div>
            <div class="layui-col-md6 layui-form-item">
                <label class="layui-form-label ">所属课程</label>
                <span id="curriculumName"></span>
            </div>
        </div>
        <div class="layui-row">
            <div class="layui-col-md6 layui-form-item">
                <label class="layui-form-label ">实验类型</label>
                <span id="experimentalType"></span>
            </div>
            <div class="layui-col-md6 layui-form-item">
                <label class="layui-form-label ">可被引用</label>
                <span id="cite">是</span>
            </div>
        </div>
        <div class="layui-row">
            <div class="layui-col-md6 layui-form-item">
                <label class="layui-form-label ">负责教师</label>
                <span id="userName">王小虎</span>
            </div>
        </div>
        <div class="layui-row">
            <div class="layui-col-md6 layui-form-item">
                <label class="layui-form-label">实验要求</label>
                <span id="require"></span>
            </div>
        </div>
        <div class="layui-row">
            <div class="layui-col-md6 layui-form-item">
                <label class="layui-form-label ">实验报告</label>
                <span id="labReport">333333333333</span>
            </div>
        </div>
        <div class="layui-row">
            <div class="layui-col-md6 layui-form-item">
                <label class="layui-form-label ">课件资源</label>
                <span id="experimentalData"></span>
            </div>
            <div class="source-display" id="fileUrl">
                <div id="mune_area">
                    <div class="tab_a" id="tab_b">
                        <ul class="tab1 tab1ys">
                            <li>
                                <a
                                        id="tab_ch1"
                                        class="active"
                                        href="javascript:void(0)"
                                ><img src="src/images/xue.png"
                                /></a>
                            </li>
                            <!-- <li>
                                <a id="tab_ch2"
                                   href="javascript:void(0)"><img src="src/images/lian.png" /></a>
                            </li> -->
                        </ul>
                        <ul class="tab_con tabcon_sy">
                            <li id="tabcon1">
                                <div
                                        class="munebtnlist"
                                        id="tabcon1_menulist"
                                ></div>
                            </li>
                            <li id="tabcon2" class="hidden">
                                <div class="munebtnlist">
                                    <div id="tabcon2_menulist"></div>
                                </div>
                            </li>
                        </ul>
                    </div>
                </div>
                <div id="mune_btn" class="munebtna" data-zt="a"></div>
                <div
                        id="pagecon"
                        style=" min-width: 900px; height: 500px;float: left"
                >
                    <iframe
                            frameBorder="0"
                            id="innerTarget"
                            name="innerTarget"
                            scrolling="no"
                            src="iframe2.htm"
                            style="width: 100%; height: 100%"
                    ></iframe>
                </div>
            </div>
        </div>
        <div class="layui-row">
            <div class="layui-form-item layui-col-md12">
                <label class="layui-form-label"></label>
                <div>
                    <div class="layui-btn primary-btn" id="my-details-update">修改</div>
                    <button class="layui-btn layui-btn-primary cancel-btn " id="my-details-back">返回</button>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="src/plugins/UnityLoader.js"></script>
<script src="src/plugins/UnityProgress.js"></script>
<script src="src/plugins/resource_url.js"></script>
<script src="menutree/menuTree.js"></script>

<script>
    layui.use(['table'], function (table) {

        var $ = layui.$,
            admin = layui.admin,
            router = layui.router(),
            conf = layui.conf,
            id = router.search.id;

        getDetails()

        function getDetails() {
            admin.get({
                url: '/experiments/queryById?id=' + id,
                success: function (res) {
                    $('#name').html(res.data.name)
                    $('#curriculumName').html(res.data.curriculumName)
                    $('#experimentalType').html(res.data.experimentalType)
                    $('#cite').html(res.data.cite == 0 ? '否' : '是')
                    $('#userName').html(res.data.userName)
                    $('#require').html(res.data.require)
//                    $('#resourceUrl').html(res.data.resourceUrl)

                    debugger
                    if (res.data.dataType === 2) {
                        var list = JSON.parse(res.data.resourceIds),
                            str = ''
                        for(var i = 0; i < list.length; i++) {
                            str += '<img src="' + conf.fileRequestUrl + '/' +list[i].url + '">'
                        }
                        $('#fileUrl').html(str)
                        return;
                    }
                    fileUrl = conf.fileRequestUrl + '/' + JSON.parse(res.data.resourceIds)[0].url
                    if (res.data.dataType == 1) {
                        // 文档
                        // window.open(fileUrl)
                        $('#fileUrl').hide()
                    } else if (res.data.dataType == 2) {
                        // 图片
                        $('#fileUrl').html(
                            '<img src="' +
                            fileUrl +
                            '" style="width: 100%; height: 100%;">'
                        )
                    } else if (res.data.dataType == 3) {
                        // 视频
                        $('#fileUrl').html(
                            '<video src="' +
                            fileUrl +
                            '" controls="controls" style="width: 100%; height: 100%;">'
                        )
                    } else if (res.data.dataType == 4) {
                        $('#fileUrl').html(
                            '<embed src="' +
                            fileUrl +
                            '" type="application/x-shockwave-flash" style="width: 100%; height: 100%;" quality="high" />'
                        )
                    } else if (res.data.dataType == 5) {
                        // exe
                        $('#fileUrl').hide()
                    } else if (res.data.dataType == 6) {
                        // U3D
                        $('#fileUrl').html('')
//                        var jsonFile = JSON.parse(res.data.fileUrl).json
                        UnityLoader.instantiate(
                            'fileUrl',
                            fileUrl,
                            {
                                onProgress: UnityProgress
                            }
                        )
                    } else if (res.data.dataType == 7) {
                        console.log(111222, res.data.resourceIds)
                        console.log(33333, JSON.parse(res.data.resourceIds))
                        // scorm课件
                        var sourceList = JSON.parse(res.data.resourceIds)[0].url
                        var munebtn = document.getElementById('mune_btn')
                        var mune = document.getElementById('mune_area')
                        var treeStr = ''

                        for (var i = 0; i < sourceList.length; i++) {
                            var floor = ''
                            for (
                                var k = 0;
                                k < Number(sourceList[i].floor);
                                k++
                            ) {
                                floor += '-'
                            }
                            addtree(
                                floor + sourceList[i].name,
                                'http://39.104.97.6:8001/' +
                                sourceList[i].sourceName,
                                'innerTarget'
                            )
                        }
                        createtree('tabcon1_menulist')

                        $('.menu-list').click(function() {
                            getSWFUrl(
                                'pagecon',
                                'http://39.104.97.6:8001/' +
                                sourceList[0].sourceName
                            )
                        })
                        munebtn.onclick = function() {
                            var p = $('#pagecon')
                            if (this.getAttribute('data-zt') == 'a') {
                                mune.style.display = 'none'
                                this.className = 'munebtnb'
                                this.setAttribute('data-zt', 'b')
                                p.css({ 'min-width': '1126px' })
                            } else {
                                mune.style.display = 'block'
                                this.className = 'munebtna'
                                this.setAttribute('data-zt', 'a')
                                p.css({ 'min-width': '900px' })
                            }
                        }
                    }
                }
            })
        }

        $('#my-details-update').on('click', function () {
            location.href = 'index.html#/experiment/myadd'
        })

        $('#my-details-back').on('click', function () {
            window.history.back(-1);
        })
        function download() {
            window.open(
                conf.requestUrl +
                '/dataBank/downloadFile?filePath=' +
                details.fileUrl
            )
        }
    })
</script>


<style>
    #experiment-my-details {}

    #experiment-my-details .my-details-inner {
        padding: 20px 0;
    }

    #experiment-my-details .layui-form-item span {
        display: inline-block;
        padding: 9px 15px;
        font-size: 16px;
    }
</style>